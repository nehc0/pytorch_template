2023-12-06 18:03:01 - INFO - ---------- config ----------
seed: 6
wandb_cfg: {
use_wandb: True
project: MNIST
notes: training details on the process of global rank 0
tags: ['baseline', 'LeNet5']
}
loader_cfg: {
batch_size: 32
num_workers: 8
pin_memory: True
batch_size_per_proc: 32
effective_batch_size: 32
}
model_cfg: {
num_classes: 10
}
optimizer_cfg: {
lr: 0.001
weight_decay: 0.01
}
scheduler_cfg: {
T_0: 5
T_mult: 2
}
train_cfg: {
max_epoch: 50
do_valid: True
do_test: True
save_log: True
save_best: True
save_checkpoint: True
resume_checkpoint: False
valid_start: 10
valid_step: 1
test_start: 20
test_step: 2
save_dir: ./mnist_ckpt
measure_best: accuracy
measure_mode: max
checkpoint_latest: True
checkpoint_list: [30, 40, 50]
resume_path: None
}
world_size: 1

2023-12-06 18:03:01 - INFO - ---------- Start of training. Good day! ----------
2023-12-06 18:03:10 - INFO - [GPU0] | Epoch 1/50 | Train loss: 0.30583783984184265 | Time/epoch: 9.35003 seconds
2023-12-06 18:03:19 - INFO - [GPU0] | Epoch 2/50 | Train loss: 0.24931636452674866 | Time/epoch: 9.31621 seconds
2023-12-06 18:03:30 - INFO - [GPU0] | Epoch 3/50 | Train loss: 0.23097950220108032 | Time/epoch: 10.47382 seconds
2023-12-06 18:03:41 - INFO - [GPU0] | Epoch 4/50 | Train loss: 0.22751612961292267 | Time/epoch: 10.89606 seconds
2023-12-06 18:03:51 - INFO - [GPU0] | Epoch 5/50 | Train loss: 0.08640778809785843 | Time/epoch: 9.9557 seconds
2023-12-06 18:04:00 - INFO - [GPU0] | Epoch 6/50 | Train loss: 0.2771191895008087 | Time/epoch: 9.24223 seconds
2023-12-06 18:04:09 - INFO - [GPU0] | Epoch 7/50 | Train loss: 0.019509276375174522 | Time/epoch: 9.47153 seconds
2023-12-06 18:04:19 - INFO - [GPU0] | Epoch 8/50 | Train loss: 0.34662583470344543 | Time/epoch: 9.18603 seconds
2023-12-06 18:04:28 - INFO - [GPU0] | Epoch 9/50 | Train loss: 0.06675712019205093 | Time/epoch: 8.93839 seconds
2023-12-06 18:04:38 - INFO - [GPU0] | Epoch 10/50 | Train loss: 0.1428186297416687 | Valid loss: 0.5299752950668335 | Time/epoch: 10.48466 seconds
2023-12-06 18:04:49 - INFO - [GPU0] | Epoch 11/50 | Train loss: 0.2917619049549103 | Valid loss: 0.5101646184921265 | Time/epoch: 10.46408 seconds
2023-12-06 18:05:00 - INFO - [GPU0] | Epoch 12/50 | Train loss: 0.169599711894989 | Valid loss: 0.3343842923641205 | Time/epoch: 11.38637 seconds
2023-12-06 18:05:11 - INFO - [GPU0] | Epoch 13/50 | Train loss: 0.027855785563588142 | Valid loss: 0.35485702753067017 | Time/epoch: 11.14393 seconds
2023-12-06 18:05:22 - INFO - [GPU0] | Epoch 14/50 | Train loss: 0.06291104108095169 | Valid loss: 0.022437630221247673 | Time/epoch: 11.20632 seconds
2023-12-06 18:05:34 - INFO - [GPU0] | Epoch 15/50 | Train loss: 0.09289665520191193 | Valid loss: 0.1606457233428955 | Time/epoch: 11.55805 seconds
2023-12-06 18:05:45 - INFO - [GPU0] | Epoch 16/50 | Train loss: 0.38740843534469604 | Valid loss: 0.41671839356422424 | Time/epoch: 11.27778 seconds
2023-12-06 18:05:57 - INFO - [GPU0] | Epoch 17/50 | Train loss: 0.12180568277835846 | Valid loss: 0.20954690873622894 | Time/epoch: 11.4811 seconds
2023-12-06 18:06:08 - INFO - [GPU0] | Epoch 18/50 | Train loss: 0.09442346543073654 | Valid loss: 0.5155238509178162 | Time/epoch: 10.93972 seconds
2023-12-06 18:06:18 - INFO - [GPU0] | Epoch 19/50 | Train loss: 0.08951941132545471 | Valid loss: 0.3950387239456177 | Time/epoch: 10.3936 seconds
2023-12-06 18:06:39 - INFO - [GPU0] | Epoch 20/50 | Train loss: 0.08500692248344421 | Valid loss: 0.34382858872413635 | Train scores: accuracy: 0.9594833333333334 | Valid scores: accuracy: 0.9547 | Time/epoch: 20.60745 seconds
2023-12-06 18:06:39 - INFO - New best model: valid accuracy update from -inf to 0.9547
2023-12-06 18:06:39 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch20.pth ...
2023-12-06 18:06:49 - INFO - [GPU0] | Epoch 21/50 | Train loss: 0.14475710690021515 | Valid loss: 0.3351171910762787 | Time/epoch: 10.4399 seconds
2023-12-06 18:07:10 - INFO - [GPU0] | Epoch 22/50 | Train loss: 0.030992992222309113 | Valid loss: 0.5038071274757385 | Train scores: accuracy: 0.9619333333333333 | Valid scores: accuracy: 0.962 | Time/epoch: 20.92103 seconds
2023-12-06 18:07:10 - INFO - New best model: valid accuracy update from 0.9547 to 0.962
2023-12-06 18:07:10 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch22.pth ...
2023-12-06 18:07:20 - INFO - [GPU0] | Epoch 23/50 | Train loss: 0.14009039103984833 | Valid loss: 0.3467892110347748 | Time/epoch: 10.104 seconds
2023-12-06 18:07:41 - INFO - [GPU0] | Epoch 24/50 | Train loss: 0.043757177889347076 | Valid loss: 0.0062352693639695644 | Train scores: accuracy: 0.96345 | Valid scores: accuracy: 0.9638 | Time/epoch: 20.59351 seconds
2023-12-06 18:07:41 - INFO - New best model: valid accuracy update from 0.962 to 0.9638
2023-12-06 18:07:41 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch24.pth ...
2023-12-06 18:07:51 - INFO - [GPU0] | Epoch 25/50 | Train loss: 0.23599056899547577 | Valid loss: 0.42147767543792725 | Time/epoch: 10.52105 seconds
2023-12-06 18:08:12 - INFO - [GPU0] | Epoch 26/50 | Train loss: 0.0030234025325626135 | Valid loss: 0.11986131966114044 | Train scores: accuracy: 0.9699 | Valid scores: accuracy: 0.969 | Time/epoch: 20.60298 seconds
2023-12-06 18:08:12 - INFO - New best model: valid accuracy update from 0.9638 to 0.969
2023-12-06 18:08:12 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch26.pth ...
2023-12-06 18:08:22 - INFO - [GPU0] | Epoch 27/50 | Train loss: 0.1997913122177124 | Valid loss: 0.33814290165901184 | Time/epoch: 10.46537 seconds
2023-12-06 18:08:43 - INFO - [GPU0] | Epoch 28/50 | Train loss: 0.2568909823894501 | Valid loss: 0.5178723931312561 | Train scores: accuracy: 0.9717 | Valid scores: accuracy: 0.9703 | Time/epoch: 20.39691 seconds
2023-12-06 18:08:43 - INFO - New best model: valid accuracy update from 0.969 to 0.9703
2023-12-06 18:08:43 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch28.pth ...
2023-12-06 18:08:53 - INFO - [GPU0] | Epoch 29/50 | Train loss: 0.06802847981452942 | Valid loss: 0.027722474187612534 | Time/epoch: 10.5839 seconds
2023-12-06 18:09:14 - INFO - [GPU0] | Epoch 30/50 | Train loss: 0.040811460465192795 | Valid loss: 0.3173014521598816 | Train scores: accuracy: 0.9739 | Valid scores: accuracy: 0.9733 | Time/epoch: 20.46635 seconds
2023-12-06 18:09:14 - INFO - New best model: valid accuracy update from 0.9703 to 0.9733
2023-12-06 18:09:14 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch30.pth ...
2023-12-06 18:09:14 - INFO - Saving checkpoint: ./mnist_ckpt/run@231206_18:03:01/checkpoint_epoch30.pth ...
2023-12-06 18:09:24 - INFO - [GPU0] | Epoch 31/50 | Train loss: 0.002509606070816517 | Valid loss: 0.052429985255002975 | Time/epoch: 10.37565 seconds
2023-12-06 18:09:45 - INFO - [GPU0] | Epoch 32/50 | Train loss: 0.06539491564035416 | Valid loss: 0.35769590735435486 | Train scores: accuracy: 0.97695 | Valid scores: accuracy: 0.974 | Time/epoch: 20.44505 seconds
2023-12-06 18:09:45 - INFO - New best model: valid accuracy update from 0.9733 to 0.974
2023-12-06 18:09:45 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch32.pth ...
2023-12-06 18:09:55 - INFO - [GPU0] | Epoch 33/50 | Train loss: 0.009354349225759506 | Valid loss: 0.40099504590034485 | Time/epoch: 10.5616 seconds
2023-12-06 18:10:16 - INFO - [GPU0] | Epoch 34/50 | Train loss: 0.02476973831653595 | Valid loss: 0.3993091583251953 | Train scores: accuracy: 0.9768333333333333 | Valid scores: accuracy: 0.9743 | Time/epoch: 20.56746 seconds
2023-12-06 18:10:16 - INFO - New best model: valid accuracy update from 0.974 to 0.9743
2023-12-06 18:10:16 - INFO - Saving best model: ./mnist_ckpt/run@231206_18:03:01/best_model_epoch34.pth ...
2023-12-06 18:10:26 - INFO - [GPU0] | Epoch 35/50 | Train loss: 0.08714104443788528 | Valid loss: 0.26684027910232544 | Time/epoch: 10.58274 seconds
2023-12-06 18:10:47 - INFO - [GPU0] | Epoch 36/50 | Train loss: 0.10737846791744232 | Valid loss: 0.5638061165809631 | Train scores: accuracy: 0.9627333333333333 | Valid scores: accuracy: 0.9618 | Time/epoch: 20.60549 seconds
2023-12-06 18:10:57 - INFO - [GPU0] | Epoch 37/50 | Train loss: 0.1142629086971283 | Valid loss: 0.42044511437416077 | Time/epoch: 10.42029 seconds
2023-12-06 18:11:18 - INFO - [GPU0] | Epoch 38/50 | Train loss: 0.18584853410720825 | Valid loss: 0.15683065354824066 | Train scores: accuracy: 0.9602333333333334 | Valid scores: accuracy: 0.961 | Time/epoch: 20.65391 seconds
2023-12-06 18:11:29 - INFO - [GPU0] | Epoch 39/50 | Train loss: 0.05714600905776024 | Valid loss: 0.18024671077728271 | Time/epoch: 10.50664 seconds
2023-12-06 18:11:49 - INFO - [GPU0] | Epoch 40/50 | Train loss: 0.023111866787075996 | Valid loss: 0.10735207051038742 | Train scores: accuracy: 0.96595 | Valid scores: accuracy: 0.9647 | Time/epoch: 20.62254 seconds
2023-12-06 18:11:49 - INFO - Saving checkpoint: ./mnist_ckpt/run@231206_18:03:01/checkpoint_epoch40.pth ...
2023-12-06 18:12:00 - INFO - [GPU0] | Epoch 41/50 | Train loss: 0.18723516166210175 | Valid loss: 0.3315288722515106 | Time/epoch: 10.4993 seconds
2023-12-06 18:12:21 - INFO - [GPU0] | Epoch 42/50 | Train loss: 0.08962912112474442 | Valid loss: 0.1712200939655304 | Train scores: accuracy: 0.9614 | Valid scores: accuracy: 0.9593 | Time/epoch: 20.92623 seconds
2023-12-06 18:12:31 - INFO - [GPU0] | Epoch 43/50 | Train loss: 0.062697634100914 | Valid loss: 0.5049319863319397 | Time/epoch: 10.41479 seconds
2023-12-06 18:12:52 - INFO - [GPU0] | Epoch 44/50 | Train loss: 0.20514486730098724 | Valid loss: 0.6132586002349854 | Train scores: accuracy: 0.9665333333333334 | Valid scores: accuracy: 0.9663 | Time/epoch: 20.56918 seconds
2023-12-06 18:13:02 - INFO - [GPU0] | Epoch 45/50 | Train loss: 0.008717335760593414 | Valid loss: 0.31910696625709534 | Time/epoch: 10.52897 seconds
2023-12-06 18:13:23 - INFO - [GPU0] | Epoch 46/50 | Train loss: 0.12597157061100006 | Valid loss: 0.2723756730556488 | Train scores: accuracy: 0.9665833333333333 | Valid scores: accuracy: 0.9618 | Time/epoch: 20.46601 seconds
2023-12-06 18:13:33 - INFO - [GPU0] | Epoch 47/50 | Train loss: 0.014113890007138252 | Valid loss: 0.5377607345581055 | Time/epoch: 10.32613 seconds
2023-12-06 18:13:54 - INFO - [GPU0] | Epoch 48/50 | Train loss: 0.34996864199638367 | Valid loss: 0.3063226640224457 | Train scores: accuracy: 0.9686333333333333 | Valid scores: accuracy: 0.964 | Time/epoch: 20.60491 seconds
2023-12-06 18:14:04 - INFO - [GPU0] | Epoch 49/50 | Train loss: 0.0660092681646347 | Valid loss: 0.4160544276237488 | Time/epoch: 10.48606 seconds
2023-12-06 18:14:25 - INFO - [GPU0] | Epoch 50/50 | Train loss: 0.12697020173072815 | Valid loss: 0.5763812065124512 | Train scores: accuracy: 0.9677666666666667 | Valid scores: accuracy: 0.9639 | Time/epoch: 20.40596 seconds
2023-12-06 18:14:25 - INFO - Saving checkpoint: ./mnist_ckpt/run@231206_18:03:01/checkpoint_epoch50.pth ...
2023-12-06 18:14:25 - INFO - ---------- End of training. Total time: 683.87126 seconds ----------
